<!DOCTYPE html>
<html>


<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Ozamis Receipt System</title>

    <link rel="stylesheet" href="static/header-second-bar.css">
    <link rel="stylesheet" href="static/naturecss.css">
    <link rel="stylesheet" href="static/dropdown.css">    
    <link rel="stylesheet" href="static/masternavi.css">    

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.css">

    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css" rel="stylesheet"> 
   
    <link href='http://fonts.googleapis.com/css?family=Cookie' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript" src="http://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

</head>

<!-- HEADER -->

<header class="header-two-bars">

   <div class="header-first-bar">
    <div class="header-limiter">
      <h1><a href="/home">Municipality<span>Receipt</span></a></h1>
            <nav>
                <a href="/form" >FORM</a>
     
                <a href="/masterlist" class="selected" >MASTERLISTS</a>
                <div class="dropdown">
                <a href="#"   disabled>PERMIT ISSUANCE</a>
                <div class="dropdown-content">
                <a href="/issuebusinesspermit" style="color:black;">Business Permit</a>
                <p style="color:black;">_______________</p>
                <a href="/payments" style="color:black;">Official Receipt</a>


                </div>
                </div>


            </nav>

            <a href="/logout" class="logout-button">Logout</a>
    </div>
  </div>




  <div class="header-second-bar">
    <div class="header-limiter">
            <h2>User: {{ user }}</h2>

            <nav>
                <a href="/user"><i class="fa fa-group"></i> User</a>
            
            </nav>

    </div>
 </div>

</header>



<!-- CONTENT JUMBO -->

<!--CONTENT STARTS HERE -->




<link rel="stylesheet" href="static/indextest.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">   
<link rel="stylesheet" href="static/indextest.css">
<link href='http://fonts.googleapis.com/css?family=Cookie' rel='stylesheet' type='text/css'>


<div class="jumbotron jumbotron-sm">
<div class="container" id = "contact">
<div class="row">
    <h1>
        BUSINESS PERMIT MASTER
    </h1>

</div>
</div> <!-- CONTAINER ENDS -->
</div><!-- JUMBO ENDS -->



<!-- CONTENT JUMBO ENDS -->




<table id="example" class="display" width="100%" cellspacing="0">        
<thead>
    <tr>
          <th scope="col">Control no.</th>
          <th scope="col">Tax payer</th>
          <th scope="col">Tradename</th>
          <th scope="col">Representative</th>
          <th scope="col">Business Address</th>
          <th scope="col">Barangay</th>
          <th scope="col">Category</th>
          <th scope="col">Home Address</th>
          <th scope="col">Memo</th>
          <th scope="col">Issued by</th>
          <th scope="col">Issued On</th>

    </tr>
        </thead>
        <tfoot>
            <tr>
 
            </tr>
        </tfoot>
        <tbody>


         {% for row in rows %}

            <tr>

               <td>{{row[0]}}</td>
               <td>{{row[1]}}</td>
               <td>{{row[2]}}</td>
               <td>{{row[3]}}</td>
               <td>{{row[4]}}</td>
               <td>{{row[5]}}</td>
               <td>{{row[6]}}</td>
               <td>{{row[7]}}</td>
               <td>{{row[8]}}</td>
               <td>{{row[9]}}</td>
               <td>{{row[10]}}</td>
               <td>{{row[11]}}</td>

   


    



            <td><button type="button" class="btn btn-primary mybutton" data-toggle="modal" data-target="#exampleModal"  data-row-val="{{row.name}}" >Delinquent</button>



          <td><button type="button" class="btn btn-info btn" data-toggle="modal" data-target="#payModal">Quarterly Due</button></td>



            </tr>

         {% endfor %}


        </tbody>
    </table>

<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
<div class="modal-dialog" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="exampleModalLabel">Make Delinquent</h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>


    <form class="form-horizontal" action="/businesspermits/makedeliquent" method="POST" role="form">
      <input type="text" name="entity_key" class="hidden">
    <div class="modal-body edit-body">
    <div class="form-group">
 
    <label for="payor" class="col-sm-2 control-label">Name</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" id="payor" name="payor" placeholder="Enter name to confirm delinquency" value="">
    </div>

  </div>
  <div class="form-group">
    <label for="penalty" class="col-sm-2 control-label">Due Date</label>
    <div class="col-sm-10">
      <input type="date" class="form-control" id="date" name="date">
    </div>
  </div>

  <div class="form-group">
    <label for="penalty" class="col-sm-2 control-label">Penalty</label>
    <div class="col-sm-10">
      <input type="number" class="form-control" id="penalty" name="penalty" placeholder="Amount">
    </div>
  </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
      <button type="submit" class="btn btn-primary">Save changes</button>
      </form>
          
    </div>
  </div>
</div>
</div>

    <!-- Modal -->

    <div class="modal fade" id="editRow" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-content">
        <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Edit</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        </div>



        <form class="form-horizontal" action="/businesspermits/edit" method="POST" role="form">
        <input type="text" name="entity_key" class="hidden">
        <div class="modal-body edit-body">
        <div class="form-group">
        <label for="cont" class="col-sm-2 control-label">Control No:</label>
        <div class="col-sm-10">
        <input type="number" class="form-control" id="cont" name="cont" value="">
        </div>
        </div>
        <div class="form-group">
        <label for="tpayer" class="col-sm-2 control-label">Tax Payer</label>
        <div class="col-sm-10">
        <input type="text" class="form-control" id="tpayer" placeholder="..."name="tpayer">
        </div>
        </div>

        <div class="form-group">
        <label for="trname" class="col-sm-2 control-label">Tradename</label>
        <div class="col-sm-10">
        <input type="text" class="form-control" id="" name="trname" placeholder="...">
        </div>
        </div>

        <div class="form-group">
        <label for="rep" class="col-sm-2 control-label">Representative</label>
        <div class="col-sm-10">
        <input type="text" class="form-control" id="rep" name="rep" placeholder="...">
        </div>
        </div>

        <div class="form-group">
        <label for="b_adr" class="col-sm-2 control-label">Buisness Address</label>
        <div class="col-sm-10">
        <input type="text" class="form-control" id="b-adr" name="b_adr" placeholder="...">
        </div>
        </div>

        <div class="form-group">
        <label for="brgy" class="col-sm-2 control-label">Barangay</label>
        <div class="col-sm-10">
        <input type="text" class="form-control" id="brgy" name="brgy" placeholder="...">
        </div>
        </div>

        <div class="form-group">
        <label for="catg" class="col-sm-2 control-label">Category</label>
        <div class="col-sm-10">
        <input type="text" class="form-control" id="catg" name="catg" placeholder="...">
        </div>
        </div>

        <div class="form-group">
        <label for="hadr" class="col-sm-2 control-label">Home Address</label>
        <div class="col-sm-10">
        <input type="text" class="form-control" id="hadr" name="hadr" placeholder="...">
        </div>
        </div>


        <div class="form-group">
        <label for="memo" class="col-sm-2 control-label">Memo</label>
        <div class="col-sm-10">
        <input type="text" class="form-control" id="memo" name="memo" placeholder="...">
        </div>
        </div>

        <div class="form-group">
        <label for="isby" class="col-sm-2 control-label">Issued By</label>
        <div class="col-sm-10">
        <input type="isby" class="form-control" id="isby" name="isby" placeholder="">
        </div>
        </div>

        </div>
        <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary">Save changes</button>
        </form>
        </div>
        </div>
        </div>


<!-- Pay MOdall -->
<div class="modal" id="payModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Payments</h3>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">

        <div class="row">
          <div class="col-xs-3">
            <div class="form-group">
                <select class="selectpicker form-control" id="myselect">
                {% for get in gets%}
                <option value="{{get[0]}}">{{get[0]}}</option>
                {%endfor%}
              </select>
            </div>
              <table class="table table-bordered" id="subtable">
              <thead>
                  <tr>
                    <th scope="col">Quarter</th>
                    <th scope="col">O.R.number</th>
                    <th scope="col">Action</th>
                  </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1st Quarter</td>
                    <td id="q1"> </td>
                    <td><button type="button" class="btn btn-primary subbutton" data-toggle="modal" data-target="#submodal" id="pay" data-row-val="q1" value="" >Pay</button></td>
                </tr>

                <tr>
                  <td>2nd Quarter</td>
                    <td id="q2"> </td>
                    <td><button type="button" class="btn btn-primary subbutton" data-toggle="modal" data-target="#submodal" id="pay" data-row-val="q2" value="" >Pay</button></td>
                </tr>

                <tr>
                  <td>3rd Quarter</td>
                    <td id="q3"> </td>
                    <td><button type="button" class="btn btn-primary subbutton" data-toggle="modal" data-target="#submodal" id="pay" data-row-val="q3" value=""  >Pay</button></td>
                </tr>

                <tr>
                  <td>4th Quarter</td>
                    <td id="q4"> </td>
                    <td><button type="button" class="btn btn-primary subbutton" data-toggle="modal" data-target="#submodal" id="pay" data-row-val="q4" value=""  >Pay</button></td>
                </tr>

              </tbody>
            </table>
            </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
</div>
</div>







<div class="modal fade bd-example-modal-sm" id="submodal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content subPay">
        <form class="payProcess" action="/businesspermits/pay" method="post">

        Amount: <input type="text"  name="postAmount" value="">
                <input type="hidden" id="year" name="year" value="">
                <input type="hidden" id="quarter" name="quarter" value="">


      <div class="modal-footer">
          <button type=submit class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-sm">Pocess</button>
          </form>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


  



   <script type="text/javascript">
  $(document).ready(function() {


       $('.mybutton').click(function(){
              var my_row_value = $(this).attr('data-row-val');
              $(".edit-body #cont").val(my_row_value );
            })


       $('#example').DataTable();

        $('.subbutton').click(function(){
            var my_row_value = $(this).attr('data-row-val');
            var year = $('#myselect').val()
            console.log(year)
            console.log(my_row_value)
            $(".payProcess #quarter").val(my_row_value );
            $(".payProcess #year").val(year);
          })


          $('#myselect').change(function(){
            alert('sdfsdf')
            var send = $(this).val();
            $('.payProcess #year').val(send);
            $.ajax({

                data:{
                  sent: send
                },
                type: 'POST',
                url: '/businesspermits'
            })
            .done(function(data){

              data=JSON.parse(data)
              $('#q1').html(data[1])
              $('#q2').html(data[2])
              $('#q3').html(data[3])
              $('#q4').html(data[4])
            })
          })
} );

  </script>




    </body>
  
    </html>


